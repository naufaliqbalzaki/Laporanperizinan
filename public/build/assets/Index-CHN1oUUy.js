import{j as e,r as j,A as o,y as g,Y as N,b as m}from"./app-BNDjhMuB.js";import{D as B,a as x}from"./DataTableColumnHeader-Bk0Uevxh.js";import{c as C,a as T,B as h}from"./button-CCRufjy2.js";import{A as F}from"./AuthenticatedLayout-dr0awWZy.js";import{D as H,T as K}from"./index-CfjhtM0k.js";import{A as p,a as b,b as f,c as y,d as k,e as w,f as v,g as D,h as A}from"./alert-dialog-DoAyoDaK.js";import"./popover-BxgEQXH-.js";import"./index-BKwPXhZW.js";import"./index-4OSEfcuy.js";import"./input-CvkLJe1c.js";const I=T("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function U({className:u,variant:d,...i}){return e.jsx("div",{className:C(I({variant:d}),u),...i})}function V({appUrl:u,onDelete:d,selectedRows:i,setSelectedRows:r,files:t}){return[{accessorKey:"select",header:()=>e.jsx("input",{type:"checkbox",onChange:a=>{const s=a.target.checked;r(s?t:[])},checked:i.length===t.length&&t.length>0}),cell(a){const s=i.some(n=>n.name===a.row.original.name);return e.jsx("input",{type:"checkbox",checked:s,onChange:n=>{const c=n.target.checked;r(c?[...i,a.row.original]:i.filter(l=>l.name!==a.row.original.name))}})}},{accessorKey:"name",header:({column:a})=>e.jsx(x,{column:a,title:"Nama File"}),cell(a){return a.row.index===0?e.jsxs(e.Fragment,{children:[a.getValue(),e.jsx(U,{className:"ml-4 bg-green-500 text-foreground",children:"Baru"})]}):e.jsx(e.Fragment,{children:a.getValue()})}},{accessorKey:"created_at",header:({column:a})=>e.jsx(x,{column:a,title:"Tanggal Dibuat"}),cell(a){const s=a.getValue(),n=new Date(s);return e.jsx("span",{children:n.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})}},{accessorKey:"size",header:({column:a})=>e.jsx(x,{column:a,title:"Ukuran"}),cell(a){return e.jsxs("span",{children:[(a.getValue()/1e3).toFixed(2)," KB"]})}},{accessorKey:"action",header:()=>e.jsx("div",{className:"text-center",children:"Aksi"}),cell(a){return e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(h,{variant:"ghost",type:"button",className:"bg-blue-500 bg-opacity-5",onClick:async()=>{const s=await m.get(route("backups.download",a.row.original.name)),n=window.URL.createObjectURL(new Blob([s.data])),c=document.createElement("a");c.href=n,c.setAttribute("download",a.row.original.name),document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(n),o.success("Berhasil mengunduh file.")},children:e.jsx(H,{className:"w-5 h-5 text-blue-500"})}),e.jsxs(p,{children:[e.jsx(b,{asChild:!0,children:e.jsx(h,{variant:"ghost",type:"button",className:"bg-red-500 bg-opacity-5",children:e.jsx(K,{className:"w-5 h-5 text-red-500"})})}),e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(k,{children:"Konfirmasi Hapus"}),e.jsxs(w,{children:["Apakah Anda Yakin Ingin Menghapus File ",e.jsx("b",{children:a.row.original.name}),"?"]})]}),e.jsxs(v,{children:[e.jsx(D,{children:"Batal"}),e.jsx(A,{onClick:()=>d(a.row.original.name),className:"bg-red-500 text-white",children:"Hapus"})]})]})]})]})}}]}function _({auth:u,files:d,appUrl:i,flash:r}){const[t,a]=j.useState([]),s=async()=>{if(t.length!==0)try{await Promise.all(t.map(l=>m.delete(route("backups.delete",l.name)))),o.success(`${t.length} file berhasil dihapus.`),a([]),g.reload()}catch{o.error("Gagal menghapus beberapa file.")}},c=V({appUrl:i,onDelete:async l=>{try{await m.delete(route("backups.delete",l)),o.success(`File ${l} berhasil dihapus.`),g.reload()}catch{o.error(`Gagal menghapus file ${l}.`)}},selectedRows:t,setSelectedRows:a,files:d});return j.useEffect(()=>{o.dismiss(),r!=null&&r.success&&o.success(r.success),r!=null&&r.error&&o.error(r.error)},[r]),e.jsxs(F,{user:u.user,header:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Backup Data"}),e.jsx(h,{onClick:()=>g.visit(route("backups.create")),children:"Buat Backup"})]}),t.length>0&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(p,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(h,{variant:"destructive",size:"sm",className:"h-8",children:["Hapus ",t.length," Baris Terpilih"]})}),e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsxs(k,{children:["Hapus ",t.length," Baris Terpilih"]}),e.jsxs(w,{children:["Apakah Anda Yakin Ingin Menghapus ",t.length," File Terpilih?"]})]}),e.jsxs(v,{children:[e.jsx(D,{children:"Batal"}),e.jsx(A,{onClick:s,className:"bg-red-500 text-white",children:"Hapus"})]})]})]})})]}),children:[e.jsx(N,{title:"Backup"}),e.jsx("div",{className:"px-8 pb-8 mx-auto max-w-[1728px]",children:e.jsx(B,{columns:c,data:d,showToolbar:!1})})]})}export{_ as default};
